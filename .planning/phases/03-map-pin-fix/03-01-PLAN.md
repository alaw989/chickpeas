---
phase: 03-map-pin-fix
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - components/sections/MapDisplay.vue
autonomous: true

must_haves:
  truths:
    - "Map pin displays chickpea logo image instead of SVG circles"
    - "Pin maintains proper sizing and positioning on the map"
    - "Popup shows restaurant name on click"
  artifacts:
    - path: "components/sections/MapDisplay.vue"
      provides: "Map marker with chickpea logo image"
      contains: "chickpea-icon.webp"
  key_links:
    - from: "components/sections/MapDisplay.vue"
      to: "/img/chickpea-icon.webp"
      via: "img src in L.divIcon html"
      pattern: "chickpea-icon\\.webp"
---

<objective>
Replace the abstract SVG circles in the map pin with the actual chickpea logo image.

Purpose: The current map pin uses two green circles as a placeholder representation of chickpeas. Using the actual chickpea-icon.webp image will create visual consistency with the restaurant branding.

Output: Updated MapDisplay.vue with image-based pin marker
</objective>

<execution_context>
@/Users/austinlaw/.claude/get-shit-done/workflows/execute-plan.md
@/Users/austinlaw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@components/sections/MapDisplay.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace SVG circles with chickpea logo image</name>
  <files>components/sections/MapDisplay.vue</files>
  <action>
Modify the chickpeaPinIcon L.divIcon html to:

1. Replace the two `<circle>` elements (lines 46-47) with an `<image>` element:
   - Use `<image href="/img/chickpea-icon.webp" ...>` (SVG image element, not HTML img)
   - Position at x="6" y="6" to center within the r="14" circle area
   - Set width="28" height="28" to fill the inner circle (diameter = 2 * 14 = 28)
   - Add preserveAspectRatio="xMidYMid slice" for proper scaling

2. Keep the existing pin structure:
   - pin-shadow path (drop shadow effect)
   - pin-body path (green pin shape with #3f6e4d fill)
   - pin-inner circle (cream #e6fbcc background behind the image)

3. Add clipPath to ensure image stays within circular bounds:
   - Define a `<clipPath id="pin-clip"><circle cx="20" cy="20" r="14"/></clipPath>` in a `<defs>` block
   - Apply clip-path="url(#pin-clip)" to the image element

The final SVG structure should be:
```
<svg viewBox="0 0 40 52">
  <defs>
    <clipPath id="pin-clip">
      <circle cx="20" cy="20" r="14"/>
    </clipPath>
  </defs>
  <path class="pin-shadow" .../>
  <path class="pin-body" .../>
  <circle class="pin-inner" cx="20" cy="20" r="14" fill="#e6fbcc"/>
  <image href="/img/chickpea-icon.webp" x="6" y="6" width="28" height="28" clip-path="url(#pin-clip)" preserveAspectRatio="xMidYMid slice"/>
</svg>
```

Note: Using SVG `<image>` element (not HTML `<img>`) because this is embedded within an SVG context.
  </action>
  <verify>
1. Run `npm run dev` and navigate to the map section
2. Visually confirm the pin shows the chickpea logo image
3. Click the pin to verify popup still displays "Chickpea's Mediterranean Kitchen"
4. Check browser console for any image loading errors
  </verify>
  <done>
Map pin displays chickpea-icon.webp image clipped to a circle, centered in the pin, with popup functionality intact.
  </done>
</task>

</tasks>

<verification>
1. Dev server runs without errors
2. Map renders with custom pin marker
3. Pin displays chickpea logo image (not SVG circles)
4. Image is properly clipped to circular shape
5. Popup works on pin click
6. Pin animation (bounce) still functions
</verification>

<success_criteria>
- Map pin shows /img/chickpea-icon.webp instead of SVG circles
- Pin maintains proper sizing (40x52px) and positioning (anchored at bottom center)
- Popup displays restaurant name on click
- No console errors related to image loading
</success_criteria>

<output>
After completion, create `.planning/phases/03-map-pin-fix/03-01-SUMMARY.md`
</output>
