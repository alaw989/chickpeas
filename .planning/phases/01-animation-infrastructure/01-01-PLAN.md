---
phase: 01-animation-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - nuxt.config.ts
  - assets/css/main.css
autonomous: true

must_haves:
  truths:
    - "@vueuse/motion is installed as a dependency"
    - "Motion module is registered in nuxt.config.ts"
    - "Motion directives (v-motion) are auto-imported and available"
    - "prefers-reduced-motion is respected via CSS media query"
    - "Dev server starts without errors"
  artifacts:
    - path: "package.json"
      provides: "@vueuse/motion dependency"
      contains: "@vueuse/motion"
    - path: "nuxt.config.ts"
      provides: "Motion module registration"
      contains: "@vueuse/motion/nuxt"
    - path: "assets/css/main.css"
      provides: "Reduced motion CSS rule"
      contains: "prefers-reduced-motion"
  key_links:
    - from: "nuxt.config.ts"
      to: "@vueuse/motion/nuxt"
      via: "modules array"
      pattern: "modules.*@vueuse/motion"
---

<objective>
Set up @vueuse/motion animation library and accessibility foundations for the Chickpeas website.

Purpose: Establish the animation infrastructure that Phase 2 will use for scroll-triggered animations.
Output: Working @vueuse/motion integration with prefers-reduced-motion support.
</objective>

<execution_context>
@/Users/austinlaw/.claude/get-shit-done/workflows/execute-plan.md
@/Users/austinlaw/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@nuxt.config.ts
@package.json
@assets/css/main.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install and configure @vueuse/motion</name>
  <files>package.json, nuxt.config.ts</files>
  <action>
1. Install @vueuse/motion as a dependency:
   ```bash
   npm install @vueuse/motion
   ```

2. Add the motion module to nuxt.config.ts modules array:
   ```typescript
   modules: [
     '@nuxtjs/tailwindcss',
     '@nuxt/content',
     '@nuxt/eslint',
     '@nuxt/fonts',
     '@nuxt/icon',
     '@nuxt/image',
     '@nuxt/scripts',
     '@vueuse/motion/nuxt',  // Add this line
   ],
   ```

3. Optionally add motion configuration after the modules array (for future custom presets):
   ```typescript
   motion: {
     directives: {
       // Custom motion presets will be added in Phase 2
     }
   },
   ```

Note: @vueuse/motion/nuxt auto-imports the v-motion directive and motion composables (useMotion, useSpring, etc.) so no manual imports are needed in components.
  </action>
  <verify>
Run `npm run dev` and confirm the server starts without errors. Check the Nuxt dev tools to verify the motion module is loaded.
  </verify>
  <done>
@vueuse/motion is in package.json dependencies and registered as a Nuxt module. Dev server runs without motion-related errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add prefers-reduced-motion CSS support</name>
  <files>assets/css/main.css</files>
  <action>
Add a CSS media query at the end of main.css to disable animations when the user has reduced motion enabled:

```css
/* Accessibility: Respect prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
```

This CSS rule:
- Applies to all elements when user has prefers-reduced-motion: reduce enabled
- Disables CSS animations by setting near-zero duration
- Disables CSS transitions
- Disables smooth scrolling
- Uses !important to override inline styles from animation libraries

Note: @vueuse/motion also respects prefers-reduced-motion by default, but this CSS provides a fallback for any CSS animations and ensures consistent behavior.
  </action>
  <verify>
1. Open browser DevTools > Rendering > Emulate CSS media feature prefers-reduced-motion: reduce
2. Confirm the CSS rule is applied by checking Computed styles on any element
3. Run `npm run dev` to verify no CSS errors
  </verify>
  <done>
prefers-reduced-motion CSS media query is in main.css. Animations are disabled when reduced motion is preferred.
  </done>
</task>

</tasks>

<verification>
After completing both tasks:

1. **Dependency check**: `npm list @vueuse/motion` shows the package is installed
2. **Module check**: `grep -q "@vueuse/motion/nuxt" nuxt.config.ts && echo "Motion module configured"`
3. **CSS check**: `grep -q "prefers-reduced-motion" assets/css/main.css && echo "Reduced motion CSS in place"`
4. **Server check**: `npm run dev` starts without errors
5. **Quick smoke test**: Create a temporary test in any component:
   ```vue
   <div v-motion :initial="{ opacity: 0 }" :enter="{ opacity: 1 }">
     Test animation
   </div>
   ```
   The element should fade in on page load.
</verification>

<success_criteria>
- @vueuse/motion appears in package.json dependencies
- @vueuse/motion/nuxt is in nuxt.config.ts modules array
- prefers-reduced-motion media query exists in main.css
- `npm run dev` starts successfully
- v-motion directive is available in components (auto-imported)
</success_criteria>

<output>
After completion, create `.planning/phases/01-animation-infrastructure/01-01-SUMMARY.md`
</output>
